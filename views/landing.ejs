<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ïò§Ìîà ÌïúÏùå(Open Haneum)</title>
    <meta name="description" content="Ïò§Ìîà ÌïúÏùåÏùÄ AIÎ•º ÌôúÏö©ÌïòÏó¨ ÎÖ∏Îûò Í∞ÄÏÇ¨Ïùò Î≤àÏó≠, Î∞úÏùå, Îã®Ïñ¥, Î¨∏Î≤ïÏùÑ Î∂ÑÏÑùÌïòÏó¨ Ïô∏Íµ≠Ïñ¥ ÌïôÏäµÏùÑ ÎèïÎäî Ïõπ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏûÖÎãàÎã§.">
    <meta name="keywords" content="Í∞ÄÏÇ¨ Î∂ÑÏÑù, Ïô∏Íµ≠Ïñ¥ ÌïôÏäµ, Îã®Ïñ¥Ïû•, AI, ÏùºÎ≥∏Ïñ¥, Ï§ëÍµ≠Ïñ¥, ÏòÅÏñ¥, ÌïúÏûê, Î∞úÏùå, ÎÖ∏Îûò Î≤àÏó≠, ÎÖ∏Îûò Í∞ÄÏÇ¨, ÎÖ∏Îûò Î∞úÏùå, ÎÖ∏Îûò Îã®Ïñ¥">
    <meta name="naver-site-verification" content="3d8f3a813eb3c5fed2eee7ed101ca90d98c30ae5" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
    <script>
        window.onload = function() {
            if(location.hostname != "localhost") {
                if (window.location.protocol != "https:") {
                    window.location.href = "https:" + window.location.href.substring(window.location.protocol.length);
                }

                if (document.location.protocol == 'http:') {
                    document.location.href = document.location.href.replace('http:', 'https:');
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body class="bg-gray-100 text-gray-800 font-sans leading-relaxed">
    <!-- Ìó§Îçî -->
    <header id="hero" class="text-white text-center py-24 md:py-32 px-6 bg-gradient-to-r from-blue-600 to-indigo-600">
        <div class="container mx-auto max-w-4xl">
            <h1 class="text-4xl md:text-5xl font-bold mb-4 leading-tight">HaneumÍ≥º Ìï®Íªò Ïñ¥Îñ§ Ïô∏Íµ≠Ïñ¥Îì† ÎÖ∏ÎûòÎ°ú Ï¶êÍ≤ÅÍ≤å Í≥µÎ∂ÄÌïòÏÑ∏Ïöî.</h1>
            <form action="/songs" method="get" class="flex flex-col sm:flex-row justify-center max-w-xl mx-auto">
                <input type="search" name="q" placeholder="ÎÖ∏Îûò Ï†úÎ™© ÎòêÎäî ÏïÑÌã∞Ïä§Ìä∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                       class="flex-grow px-5 py-4 rounded-full sm:rounded-r-none text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 mb-2 sm:mb-0 text-lg">
                <button type="submit"
                        class="bg-white text-blue-600 font-semibold px-8 py-4 rounded-full sm:rounded-l-none transition duration-300 ease-in-out text-lg inline-flex items-center justify-center gap-2">
                    <i class="fas fa-search"></i> ÎÖ∏Îûò Ï∞æÍ∏∞
                </button>
            </form>
            <div class="flex justify-center gap-4 mt-6">
                <a href="/add-song" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold px-6 py-3 rounded-full transition duration-300 ease-in-out text-lg inline-flex items-center justify-center gap-2">
                    <i class="fas fa-plus"></i> ÎÖ∏Îûò Ï∂îÍ∞ÄÌïòÍ∏∞
                </a>
                <a href="/songs" class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold px-6 py-3 rounded-full transition duration-300 ease-in-out text-lg inline-flex items-center justify-center gap-2">
                    <i class="fas fa-list"></i> Ï†ÑÏ≤¥ ÎÖ∏Îûò Î≥¥Í∏∞
                </a>
            </div>
        </div>
    </header>

    <main>
        <!-- Ï£ºÏöî ÌäπÏßï ÏÑπÏÖò -->
        <!-- <section class="bg-white py-16 px-6">
            <div class="container mx-auto max-w-6xl">
                <h2 class="text-3xl font-semibold text-center mb-12">HaneumÎßåÏùò ÌäπÎ≥ÑÌï®</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-10 text-center">
                   
                    <div class="feature-item p-4">
                        <i class="fas fa-mobile-alt text-4xl text-blue-600 mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">Ìé∏Î¶¨Ìïú ÏÇ¨Ïö©ÏÑ±</h3>
                        <p class="text-gray-600">PC/Î™®Î∞îÏùº Ïñ¥ÎîîÏÑúÎì† ÏµúÏ†ÅÌôîÎêú ÌôîÎ©¥, ÏßÅÍ¥ÄÏ†ÅÏù∏ ÎîîÏûêÏù∏</p>
                    </div>
                    <div class="feature-item p-4">
                        <i class="fas fa-language text-4xl text-blue-600 mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">Îã§Íµ≠Ïñ¥ ÏßÄÏõê</h3>
                        <p class="text-gray-600">ÌïúÍµ≠Ïñ¥, ÏòÅÏñ¥, ÏùºÎ≥∏Ïñ¥ Îì± Îã§ÏñëÌïú Ïñ∏Ïñ¥Ïùò Í∞ÄÏÇ¨ Ï†úÍ≥µ</p>
                    </div>
                </div>
            </div>
        </section> -->

        <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† Í∑∏Î¶¨Îìú -->
        <section class="py-16 px-6">
            <div class="container mx-auto max-w-7xl">
                <!-- Î°úÎî© Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ -->
                <div id="loading" class="hidden text-center py-16">
                    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                    <p class="mt-4 text-gray-600">Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...</p>
                </div>
                
                <!-- Ïñ∏Ïñ¥ ÌïÑÌÑ∞ -->
                <div class="mb-8">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                                <i class="fas fa-filter text-blue-600 mr-2"></i>
                                Ïñ∏Ïñ¥Î≥Ñ ÌïÑÌÑ∞
                            </h3>
                            <div class="text-xs text-gray-500">
                                ÏõêÌïòÎäî Ïñ∏Ïñ¥Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî
                            </div>
                        </div>
                        <div class="flex justify-start flex-wrap gap-3">
                            <button onclick="filterByLanguage('all')" 
                                    class="language-filter <%= (currentLanguage || 'all') === 'all' ? 'active bg-blue-600 text-white hover:bg-blue-700' : 'bg-gray-100 hover:bg-blue-600 text-gray-700 hover:text-white' %> font-semibold px-5 py-2.5 rounded-full transition duration-300 ease-in-out text-sm shadow-sm">
                                Ï†ÑÏ≤¥
                            </button>
                            <button onclick="filterByLanguage('english')" 
                                    class="language-filter <%= (currentLanguage || 'all') === 'english' ? 'active bg-blue-600 text-white hover:bg-blue-700' : 'bg-gray-100 hover:bg-blue-600 text-gray-700 hover:text-white' %> font-semibold px-5 py-2.5 rounded-full transition duration-300 ease-in-out text-sm shadow-sm">
                                ÏòÅÏñ¥
                            </button>
                            <button onclick="filterByLanguage('japanese')" 
                                    class="language-filter <%= (currentLanguage || 'all') === 'japanese' ? 'active bg-blue-600 text-white hover:bg-blue-700' : 'bg-gray-100 hover:bg-blue-600 text-gray-700 hover:text-white' %> font-semibold px-5 py-2.5 rounded-full transition duration-300 ease-in-out text-sm shadow-sm">
                                ÏùºÎ≥∏Ïñ¥
                            </button>
                            <button onclick="filterByLanguage('chinese')" 
                                    class="language-filter <%= (currentLanguage || 'all') === 'chinese' ? 'active bg-blue-600 text-white hover:bg-blue-700' : 'bg-gray-100 hover:bg-blue-600 text-gray-700 hover:text-white' %> font-semibold px-5 py-2.5 rounded-full transition duration-300 ease-in-out text-sm shadow-sm">
                                Ï§ëÍµ≠Ïñ¥
                            </button>
                            <button onclick="filterByLanguage('other')" 
                                    class="language-filter <%= (currentLanguage || 'all') === 'other' ? 'active bg-blue-600 text-white hover:bg-blue-700' : 'bg-gray-100 hover:bg-blue-600 text-gray-700 hover:text-white' %> font-semibold px-5 py-2.5 rounded-full transition duration-300 ease-in-out text-sm shadow-sm">
                                Í∏∞ÌÉÄ
                            </button>
                        </div>
                    </div>
                </div>

                <div id="main-content" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    
                    <!-- ÏµúÍ∑º Ï∂îÍ∞ÄÎêú ÎÖ∏Îûò (Î©îÏù∏ Ïª¨Îüº) -->
                    <div class="lg:col-span-2">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                                <i class="fas fa-clock text-blue-600 mr-3"></i>
                                ÏµúÍ∑º Ï∂îÍ∞ÄÎêú ÎÖ∏Îûò
                            </h2>
                            <a href="javascript:void(0)" onclick="goToSongsPage()" class="text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center cursor-pointer">
                                ÎçîÎ≥¥Í∏∞ <i class="fas fa-arrow-right ml-1"></i>
                            </a>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <% latestSongs.slice(0, 16).forEach(song => { %>
                                <div class="group bg-white rounded-2xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100 hover:border-blue-200 hover:-translate-y-1">
                                    <div class="p-6">
                                        <a href="/songs/<%= song.name %>" class="block">
                                            <div class="flex items-start justify-between mb-3">
                                                <div class="flex-1">
                                                    <h3 class="font-bold text-lg text-gray-800 group-hover:text-blue-600 transition-colors line-clamp-2 leading-tight">
                                                        <%= song.ori_name || song.name %>
                                                    </h3>
                                                </div>
                                                <div class="flex-shrink-0 ml-3">
                                                    <div class="w-2 h-2 bg-blue-400 rounded-full opacity-60 group-hover:opacity-100 group-hover:scale-150 transition-all duration-300"></div>
                                                </div>
                                            </div>
                                            
                                            <div class="space-y-2">
                                                <p class="text-sm text-blue-600 font-medium">
                                                    <%= song.kor_name %>
                                                </p>
                                            </div>
                                        </a>
                                        
                                        <div class="mt-2">
                                            <div class="flex items-center space-x-2">
                                                <div class="w-6 h-6 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center">
                                                    <i class="fas fa-music text-white text-xs"></i>
                                                </div>
                                                <a href="/songs?q=<%= encodeURIComponent(typeof song.artist === 'object' ? (song.artist.kor_name || song.artist.eng_name || song.artist.ori_name) : song.artist) %>" 
                                                   class="text-sm text-gray-600 font-medium hover:text-blue-600 transition-colors cursor-pointer">
                                                    <%= typeof song.artist === 'object' ? (song.artist.kor_name || song.artist.eng_name || song.artist.ori_name) : song.artist %>
                                                </a>
                                            </div>
                                        </div>
                                        
                                        <a href="/songs/<%= song.name %>">
                                            <div class="mt-4 pt-3 border-t border-gray-100">
                                                <div class="flex items-center justify-between">
                                                    <div class="flex items-center space-x-1 text-xs text-gray-400">
                                                        <i class="fas fa-clock"></i>
                                                        <span>
                                                            <% if (song.createdAt) { %>
                                                                <%= new Date(song.createdAt).toLocaleDateString('ko-KR', {
                                                                    month: 'short',
                                                                    day: 'numeric'
                                                                }) %>
                                                            <% } else { %>
                                                                ÏµúÍ∑º
                                                            <% } %>
                                                        </span>
                                                    </div>
                                                    <div class="flex items-center space-x-1 text-xs text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                                        <span>ÌïôÏäµÌïòÍ∏∞</span>
                                                        <i class="fas fa-arrow-right"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            <% }); %>
                        </div>
                    </div>

                    <!-- ÏÇ¨Ïù¥ÎìúÎ∞î (Ïù∏Í∏∞ ÎÖ∏Îûò + Ïù∏Í∏∞ ÏïÑÌã∞Ïä§Ìä∏) -->
                    <div class="space-y-8">
                        
                        <!-- Ïù∏Í∏∞ ÎÖ∏Îûò ÏÑπÏÖò -->
                        <div class="bg-gradient-to-br from-orange-50 to-red-50 rounded-xl p-6 border border-orange-100">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-xl font-bold text-gray-800 flex items-center">
                                    <i class="fas fa-fire text-orange-500 mr-2"></i>
                                    Ïù∏Í∏∞ ÎÖ∏Îûò
                                </h2>
                                <% if (popularSongs && popularSongs.length > 0) { %>
                                    <a href="javascript:void(0)" onclick="goToPopularSongsPage()" class="text-orange-600 hover:text-orange-700 text-sm font-medium flex items-center cursor-pointer">
                                        ÎçîÎ≥¥Í∏∞ <i class="fas fa-arrow-right ml-1"></i>
                                    </a>
                                <% } %>
                            </div>
                            <% if (popularSongs && popularSongs.length > 0) { %>
                                <div class="space-y-3">
                                    <% popularSongs.slice(0, 10).forEach((song, index) => { %>
                                        <div class="flex items-center space-x-3 p-3 bg-white rounded-lg hover:shadow-md transition-shadow duration-200">
                                            <div class="flex-shrink-0 w-6 h-6 rounded-full bg-gradient-to-r from-orange-400 to-red-400 flex items-center justify-center text-white text-xs font-bold">
                                                <%= index + 1 %>
                                            </div>
                                            <div class="flex-1 min-w-0">
                                                <a href="/songs/<%= song.name %>" class="block hover:text-orange-600 transition-colors">
                                                    <p class="font-medium text-gray-800 truncate">
                                                        <%= song.ori_name || song.name %>
                                                    </p>
                                                    <p class="text-xs text-gray-500 truncate">
                                                        <%= typeof song.artist === 'object' ? (song.artist.kor_name || song.artist.eng_name || song.artist.ori_name) : song.artist %>
                                                    </p>
                                                </a>
                                            </div>
                                            <div class="flex-shrink-0 text-xs text-orange-600 font-medium flex items-center">
                                                <i class="fas fa-eye mr-1"></i>
                                                <%= song.views.toLocaleString() %>
                                            </div>
                                        </div>
                                    <% }); %>
                                </div>
                            <% } else { %>
                                <div class="text-center py-8 text-gray-500">
                                    <i class="fas fa-music text-4xl mb-3 opacity-50"></i>
                                    <p>ÏïÑÏßÅ Ï°∞Ìöå Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                                    <p class="text-sm">ÎÖ∏ÎûòÎ•º Îì£Í≥† Ïù∏Í∏∞ Ï∞®Ìä∏Î•º ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî!</p>
                                </div>
                            <% } %>
                        </div>

                        <!-- Ïù∏Í∏∞ ÏïÑÌã∞Ïä§Ìä∏ ÏÑπÏÖò -->
                        <div class="bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-6 border border-purple-100">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-xl font-bold text-gray-800 flex items-center">
                                    <i class="fas fa-star text-purple-500 mr-2"></i>
                                    Ïù∏Í∏∞ ÏïÑÌã∞Ïä§Ìä∏
                                </h2>
                                <% if (popularArtists && popularArtists.length > 0) { %>
                                    <a href="javascript:void(0)" onclick="goToPopularArtistsPage()" class="text-purple-600 hover:text-purple-700 text-sm font-medium flex items-center cursor-pointer">
                                        ÎçîÎ≥¥Í∏∞ <i class="fas fa-arrow-right ml-1"></i>
                                    </a>
                                <% } %>
                            </div>
                            <% if (popularArtists && popularArtists.length > 0) { %>
                                <div class="space-y-3">
                                    <% popularArtists.slice(0, 10).forEach((artist, index) => { %>
                                        <a href="/songs?q=<%= encodeURIComponent(artist.name) %>" class="block">
                                            <div class="flex items-center space-x-3 p-4 bg-white rounded-lg hover:shadow-lg hover:scale-105 transition-all duration-200 cursor-pointer group">
                                                <div class="flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-r from-purple-400 to-indigo-400 flex items-center justify-center text-white text-sm font-bold group-hover:from-purple-500 group-hover:to-indigo-500 transition-colors">
                                                    <%= index + 1 %>
                                                </div>
                                                <div class="flex-1 min-w-0">
                                                    <p class="font-medium text-gray-800 truncate group-hover:text-purple-600 transition-colors">
                                                        <%= artist.name %>
                                                    </p>
                                                    <p class="text-xs text-gray-500 group-hover:text-gray-600 transition-colors">
                                                        <%= artist.songs.length %>Í≥° ‚Ä¢ <i class="fas fa-eye"></i> <%= artist.totalViews.toLocaleString() %>
                                                    </p>
                                                </div>
                                            </div>
                                        </a>
                                    <% }); %>
                                </div>
                            <% } else { %>
                                <div class="text-center py-8 text-gray-500">
                                    <div class="text-6xl mb-3 opacity-50">üé≠</div>
                                    <p>ÏïÑÏßÅ ÏïÑÌã∞Ïä§Ìä∏ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                                    <p class="text-sm">ÎÖ∏ÎûòÎ•º Îì£Í≥† Ïù∏Í∏∞ ÏïÑÌã∞Ïä§Ìä∏Î•º ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî!</p>
                                </div>
                            <% } %>
                        </div>

                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Ìë∏ÌÑ∞ -->
    <footer class="bg-gray-800 text-gray-400 py-12 px-6 text-center">
        <div class="container mx-auto max-w-6xl">
            <!-- <nav class="mb-6">
                <ul class="flex flex-wrap justify-center gap-x-6 gap-y-2">
                    <li><a href="/about" class="hover:text-white transition duration-200">About Haneum</a></li>
                    <li><a href="/contact" class="hover:text-white transition duration-200">Î¨∏ÏùòÌïòÍ∏∞</a></li>
                    <li><a href="/privacy" class="hover:text-white transition duration-200">Í∞úÏù∏Ï†ïÎ≥¥Ï≤òÎ¶¨Î∞©Ïπ®</a></li>
                    <li><a href="/terms" class="hover:text-white transition duration-200">Ïù¥Ïö©ÏïΩÍ¥Ä</a></li>
                    <li><a href="/copyright" class="hover:text-white transition duration-200">Ï†ÄÏûëÍ∂å ÏïàÎÇ¥</a></li>
                </ul>
            </nav> -->
            <p class="notice text-xs text-gray-500 mt-2 max-w-xl mx-auto">Î≥∏ ÏÇ¨Ïù¥Ìä∏Ïùò Í∞ÄÏÇ¨ Ï†ïÎ≥¥Îäî ÍµêÏú° Î∞è ÎπÑÏÉÅÏóÖÏ†Å Ïö©ÎèÑÎ°ú Ï†úÍ≥µÎêòÎ©∞, Ï†ÄÏûëÍ∂åÏùÄ Ìï¥Îãπ Ï†ÄÏûëÍ∂åÏûêÏóêÍ≤å ÏûàÏäµÎãàÎã§.</p>
        </div>
    </footer>

    <script>
        // Ïø†ÌÇ§ Ïú†Ìã∏Î¶¨Ìã∞ Ìï®ÏàòÎì§
        function setCookie(name, value, days = 30) {
            const expires = new Date();
            expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
            document.cookie = name + '=' + value + ';expires=' + expires.toUTCString() + ';path=/';
        }
        
        function getCookie(name) {
            const nameEQ = name + '=';
            const ca = document.cookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }

        // URL ÌååÎùºÎØ∏ÌÑ∞, Ïø†ÌÇ§, Í∏∞Î≥∏Í∞í ÏàúÏúºÎ°ú Ïñ∏Ïñ¥ ÏÑ§Ï†ï Í≤∞Ï†ï
        function getInitialLanguage() {
            const urlParams = new URLSearchParams(window.location.search);
            const urlLanguage = urlParams.get('language');
            const cookieLanguage = getCookie('preferredLanguage');
            
            return urlLanguage || cookieLanguage || 'all';
        }
        
        let currentLanguage = getInitialLanguage();
        
        // ÏÑúÎ≤ÑÏóêÏÑú Î†åÎçîÎßÅÎêú Ïñ∏Ïñ¥ (ÏÑúÎ≤ÑÏóêÏÑú Ïù¥ÎØ∏ ÌïÑÌÑ∞ÎßÅÎêú ÏÉÅÌÉú)
        const serverLanguage = '<%= currentLanguage || "all" %>';

        // Ïñ∏Ïñ¥Î≥Ñ Í≤ÄÏÉâ ÏøºÎ¶¨ Îß§Ìïë
        function getLanguageQuery(language) {
            const languageMap = {
                'english': 'ÏòÅÏñ¥',
                'japanese': 'ÏùºÎ≥∏Ïñ¥',
                'chinese': 'Ï§ëÍµ≠Ïñ¥',
                'other': '', // Í∏∞ÌÉÄÎäî ÌäπÎ≥ÑÌïú ÏøºÎ¶¨ ÏóÜÏù¥ Ï†ÑÏ≤¥ÏóêÏÑú ÏòÅÏñ¥/ÏùºÎ≥∏Ïñ¥/Ï§ëÍµ≠Ïñ¥ Ï†úÏô∏
                'all': ''
            };
            return languageMap[language] || '';
        }

        // ÎçîÎ≥¥Í∏∞ Î≤ÑÌäº ÌÅ¥Î¶≠ Ï≤òÎ¶¨ (Ïø†ÌÇ§ Í∏∞Î∞ò)
        function goToSongsPage() {
            const savedLanguage = getCookie('preferredLanguage') || 'all';
            const query = getLanguageQuery(savedLanguage);
            if (query) {
                window.location.href = `/songs?q=${encodeURIComponent(query)}`;
            } else {
                window.location.href = '/songs';
            }
        }

        // Ïù∏Í∏∞ ÎÖ∏Îûò ÎçîÎ≥¥Í∏∞ Î≤ÑÌäº ÌÅ¥Î¶≠ Ï≤òÎ¶¨ (Ïø†ÌÇ§ Í∏∞Î∞ò)
        function goToPopularSongsPage() {
            const savedLanguage = getCookie('preferredLanguage') || 'all';
            if (savedLanguage !== 'all') {
                window.location.href = `/popular/songs?language=${savedLanguage}`;
            } else {
                window.location.href = '/popular/songs';
            }
        }

        // Ïù∏Í∏∞ ÏïÑÌã∞Ïä§Ìä∏ ÎçîÎ≥¥Í∏∞ Î≤ÑÌäº ÌÅ¥Î¶≠ Ï≤òÎ¶¨ (Ïø†ÌÇ§ Í∏∞Î∞ò)
        function goToPopularArtistsPage() {
            const savedLanguage = getCookie('preferredLanguage') || 'all';
            if (savedLanguage !== 'all') {
                window.location.href = `/popular/artists?language=${savedLanguage}`;
            } else {
                window.location.href = '/popular/artists';
            }
        }

        // URL ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function updateURL(language) {
            const url = new URL(window.location);
            if (language === 'all') {
                url.searchParams.delete('language');
            } else {
                url.searchParams.set('language', language);
            }
            
            // URL ÏóÖÎç∞Ïù¥Ìä∏ (ÌéòÏù¥ÏßÄ Î¶¨Î°úÎìú ÏóÜÏù¥)
            window.history.replaceState({language: language}, '', url.toString());
        }

        // Ïñ∏Ïñ¥ ÌïÑÌÑ∞ÎßÅ Ìï®Ïàò
        async function filterByLanguage(language) {
            if (currentLanguage === language) return;
            
            currentLanguage = language;
            
            // Ïø†ÌÇ§Ïóê Ïñ∏Ïñ¥ ÏÑ§Ï†ï Ï†ÄÏû•
            setCookie('preferredLanguage', language);
            
            // URL ÏóÖÎç∞Ïù¥Ìä∏
            updateURL(language);
            
            // Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            updateFilterButtons(language);
            
            // Î°úÎî© ÌëúÏãú
            showLoading();
            
            try {
                // API Ìò∏Ï∂ú
                const response = await fetch(`/api/filter?language=${language}`);
                const data = await response.json();
                
                // ÏΩòÌÖêÏ∏† ÏóÖÎç∞Ïù¥Ìä∏
                updateMainContent(data);
                
            } catch (error) {
                console.error('ÌïÑÌÑ∞ÎßÅ Ï§ë Ïò§Î•ò:', error);
                alert('ÌïÑÌÑ∞ÎßÅ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            } finally {
                hideLoading();
            }
        }

        // ÌïÑÌÑ∞ Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        function updateFilterButtons(activeLanguage) {
            const buttons = document.querySelectorAll('.language-filter');
            buttons.forEach(button => {
                button.classList.remove('active', 'bg-blue-600', 'text-white', 'hover:bg-blue-700');
                button.classList.add('bg-gray-100', 'hover:bg-blue-600', 'text-gray-700', 'hover:text-white');
            });
            
            const activeButton = document.querySelector(`[onclick="filterByLanguage('${activeLanguage}')"]`);
            if (activeButton) {
                activeButton.classList.remove('bg-gray-100', 'hover:bg-blue-600', 'text-gray-700', 'hover:text-white');
                activeButton.classList.add('active', 'bg-blue-600', 'text-white', 'hover:bg-blue-700');
            }
        }

        // Î°úÎî© ÌëúÏãú/Ïà®ÍπÄ
        function showLoading() {
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('main-content').style.opacity = '0.5';
        }

        function hideLoading() {
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('main-content').style.opacity = '1';
        }

        // Î∏åÎùºÏö∞Ï†Ä Îí§Î°ú/ÏïûÏúºÎ°ú Í∞ÄÍ∏∞ Ï≤òÎ¶¨
        window.addEventListener('popstate', function(event) {
            const newLanguage = getInitialLanguage();
            if (newLanguage !== currentLanguage) {
                currentLanguage = newLanguage;
                setCookie('preferredLanguage', newLanguage);
                updateFilterButtons(newLanguage);
                
                if (newLanguage !== 'all') {
                    filterByLanguage(newLanguage);
                } else {
                    // Ï†ÑÏ≤¥Î°ú ÎèåÏïÑÍ∞à ÎïåÎäî ÌéòÏù¥ÏßÄ ÏÉàÎ°úÍ≥†Ïπ®
                    window.location.reload();
                }
            }
        });

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        window.addEventListener('DOMContentLoaded', function() {
            // Ïø†ÌÇ§ÏóêÏÑú Î∂àÎü¨Ïò® Ïñ∏Ïñ¥ ÏÑ§Ï†ïÏúºÎ°ú ÌïÑÌÑ∞ Î≤ÑÌäº ÏÉÅÌÉú ÏÑ§Ï†ï
            updateFilterButtons(currentLanguage);
            
            // ÏÑúÎ≤ÑÏóêÏÑú Ïù¥ÎØ∏ Ïò¨Î∞îÎ•∏ Ïñ∏Ïñ¥Î°ú Î†åÎçîÎßÅÎêú Í≤ΩÏö∞ AJAX Ìò∏Ï∂ú ÏïàÌï®
            if (currentLanguage !== serverLanguage) {
                console.log(`Ïñ∏Ïñ¥ Î∂àÏùºÏπò Í∞êÏßÄ: ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏(${currentLanguage}) vs ÏÑúÎ≤Ñ(${serverLanguage}) - AJAX Ìò∏Ï∂ú`);
                filterByLanguage(currentLanguage);
            } else if (currentLanguage !== 'all') {
                // ÏÑúÎ≤ÑÏôÄ ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ïñ∏Ïñ¥Í∞Ä Í∞ôÍ≥†, 'all'Ïù¥ ÏïÑÎãå Í≤ΩÏö∞ URLÎßå ÏóÖÎç∞Ïù¥Ìä∏
                console.log(`Ïñ∏Ïñ¥ ÏùºÏπò: ${currentLanguage} - URLÎßå ÏóÖÎç∞Ïù¥Ìä∏`);
                updateURL(currentLanguage);
            }
        });

        // Î©îÏù∏ ÏΩòÌÖêÏ∏† ÏóÖÎç∞Ïù¥Ìä∏
        function updateMainContent(data) {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <!-- ÏµúÍ∑º Ï∂îÍ∞ÄÎêú ÎÖ∏Îûò (Î©îÏù∏ Ïª¨Îüº) -->
                <div class="lg:col-span-2">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                            <i class="fas fa-clock text-blue-600 mr-3"></i>
                            ÏµúÍ∑º Ï∂îÍ∞ÄÎêú ÎÖ∏Îûò
                        </h2>
                        <a href="javascript:void(0)" onclick="goToSongsPage()" class="text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center cursor-pointer">
                            ÎçîÎ≥¥Í∏∞ <i class="fas fa-arrow-right ml-1"></i>
                        </a>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        ${data.latestSongs.map(song => `
                            <div class="group bg-white rounded-2xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100 hover:border-blue-200 hover:-translate-y-1">
                                <div class="p-6">
                                    <a href="/songs/${song.name}" class="block">
                                        <div class="flex items-start justify-between mb-3">
                                            <div class="flex-1">
                                                <h3 class="font-bold text-lg text-gray-800 group-hover:text-blue-600 transition-colors line-clamp-2 leading-tight">
                                                    ${song.ori_name || song.name}
                                                </h3>
                                            </div>
                                            <div class="flex-shrink-0 ml-3">
                                                <div class="w-2 h-2 bg-blue-400 rounded-full opacity-60 group-hover:opacity-100 group-hover:scale-150 transition-all duration-300"></div>
                                            </div>
                                        </div>
                                        
                                        <div class="space-y-2">
                                            <p class="text-sm text-blue-600 font-medium">
                                                ${song.kor_name || ''}
                                            </p>
                                        </div>
                                    </a>
                                    
                                    <div class="mt-2">
                                        <div class="flex items-center space-x-2">
                                            <div class="w-6 h-6 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center">
                                                <i class="fas fa-music text-white text-xs"></i>
                                            </div>
                                            <a href="/songs?q=${encodeURIComponent(typeof song.artist === 'object' ? (song.artist.kor_name || song.artist.eng_name || song.artist.ori_name) : song.artist)}" 
                                               class="text-sm text-gray-600 font-medium hover:text-blue-600 transition-colors cursor-pointer">
                                                ${typeof song.artist === 'object' ? (song.artist.kor_name || song.artist.eng_name || song.artist.ori_name) : song.artist}
                                            </a>
                                        </div>
                                    </div>
                                    
                                    <a href="/songs/${song.name}">
                                        <div class="mt-4 pt-3 border-t border-gray-100">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center space-x-1 text-xs text-gray-400">
                                                    <i class="fas fa-clock"></i>
                                                    <span>
                                                        ${song.createdAt ? new Date(song.createdAt).toLocaleDateString('ko-KR', {month: 'short', day: 'numeric'}) : 'ÏµúÍ∑º'}
                                                    </span>
                                                </div>
                                                <div class="flex items-center space-x-1 text-xs text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                                    <span>ÌïôÏäµÌïòÍ∏∞</span>
                                                    <i class="fas fa-arrow-right"></i>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- ÏÇ¨Ïù¥ÎìúÎ∞î (Ïù∏Í∏∞ ÎÖ∏Îûò + Ïù∏Í∏∞ ÏïÑÌã∞Ïä§Ìä∏) -->
                <div class="space-y-8">
                    <!-- Ïù∏Í∏∞ ÎÖ∏Îûò ÏÑπÏÖò -->
                    <div class="bg-gradient-to-br from-orange-50 to-red-50 rounded-xl p-6 border border-orange-100">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-bold text-gray-800 flex items-center">
                                <i class="fas fa-fire text-orange-500 mr-2"></i>
                                Ïù∏Í∏∞ ÎÖ∏Îûò
                            </h2>
                            ${data.popularSongs.length > 0 ? `
                                <a href="javascript:void(0)" onclick="goToPopularSongsPage()" class="text-orange-600 hover:text-orange-700 text-sm font-medium flex items-center cursor-pointer">
                                    ÎçîÎ≥¥Í∏∞ <i class="fas fa-arrow-right ml-1"></i>
                                </a>
                            ` : ''}
                        </div>
                        ${data.popularSongs.length > 0 ? `
                            <div class="space-y-3">
                                ${data.popularSongs.slice(0, 10).map((song, index) => `
                                    <div class="flex items-center space-x-3 p-3 bg-white rounded-lg hover:shadow-md transition-shadow duration-200">
                                        <div class="flex-shrink-0 w-6 h-6 rounded-full bg-gradient-to-r from-orange-400 to-red-400 flex items-center justify-center text-white text-xs font-bold">
                                            ${index + 1}
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <a href="/songs/${song.name}" class="block hover:text-orange-600 transition-colors">
                                                <p class="font-medium text-gray-800 truncate">
                                                    ${song.ori_name || song.name}
                                                </p>
                                                <p class="text-xs text-gray-500 truncate">
                                                    ${typeof song.artist === 'object' ? (song.artist.kor_name || song.artist.eng_name || song.artist.ori_name) : song.artist}
                                                </p>
                                            </a>
                                        </div>
                                        <div class="flex-shrink-0 text-xs text-orange-600 font-medium flex items-center">
                                            <i class="fas fa-eye mr-1"></i>
                                            ${song.views.toLocaleString()}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : `
                            <div class="text-center py-8 text-gray-500">
                                <i class="fas fa-music text-4xl mb-3 opacity-50"></i>
                                <p>ÏïÑÏßÅ Ï°∞Ìöå Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                                <p class="text-sm">ÎÖ∏ÎûòÎ•º Îì£Í≥† Ïù∏Í∏∞ Ï∞®Ìä∏Î•º ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî!</p>
                            </div>
                        `}
                    </div>

                    <!-- Ïù∏Í∏∞ ÏïÑÌã∞Ïä§Ìä∏ ÏÑπÏÖò -->
                    <div class="bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-6 border border-purple-100">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-bold text-gray-800 flex items-center">
                                <i class="fas fa-star text-purple-500 mr-2"></i>
                                Ïù∏Í∏∞ ÏïÑÌã∞Ïä§Ìä∏
                            </h2>
                            ${data.popularArtists.length > 0 ? `
                                <a href="javascript:void(0)" onclick="goToPopularArtistsPage()" class="text-purple-600 hover:text-purple-700 text-sm font-medium flex items-center cursor-pointer">
                                    ÎçîÎ≥¥Í∏∞ <i class="fas fa-arrow-right ml-1"></i>
                                </a>
                            ` : ''}
                        </div>
                        ${data.popularArtists.length > 0 ? `
                            <div class="space-y-3">
                                ${data.popularArtists.slice(0, 10).map((artist, index) => `
                                    <a href="/songs?q=${encodeURIComponent(artist.name)}" class="block">
                                        <div class="flex items-center space-x-3 p-4 bg-white rounded-lg hover:shadow-lg hover:scale-105 transition-all duration-200 cursor-pointer group">
                                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-r from-purple-400 to-indigo-400 flex items-center justify-center text-white text-sm font-bold group-hover:from-purple-500 group-hover:to-indigo-500 transition-colors">
                                                ${index + 1}
                                            </div>
                                            <div class="flex-1 min-w-0">
                                                <p class="font-medium text-gray-800 truncate group-hover:text-purple-600 transition-colors">
                                                    ${artist.name}
                                                </p>
                                                <p class="text-xs text-gray-500 group-hover:text-gray-600 transition-colors">
                                                    ${artist.songs.length}Í≥° ‚Ä¢ <i class="fas fa-eye"></i> ${artist.totalViews.toLocaleString()}
                                                </p>
                                            </div>
                                        </div>
                                    </a>
                                `).join('')}
                            </div>
                        ` : `
                            <div class="text-center py-8 text-gray-500">
                                <div class="text-6xl mb-3 opacity-50">üé≠</div>
                                <p>ÏïÑÏßÅ ÏïÑÌã∞Ïä§Ìä∏ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                                <p class="text-sm">ÎÖ∏ÎûòÎ•º Îì£Í≥† Ïù∏Í∏∞ ÏïÑÌã∞Ïä§Ìä∏Î•º ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî!</p>
                            </div>
                        `}
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html> 